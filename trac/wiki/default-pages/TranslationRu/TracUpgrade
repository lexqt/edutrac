[[TranslatedPages]]

= Инструкции по обновлению (для Trac 0.11) =

[TracEnvironment окружение Trac] должно быть обновлено перед использованием с Trac 0.11. Этот документ описывает шаги необходимые для обновления окружения.

Обновления окружения не обязательны для младших версий релизов, если обратное не оговорено отдельно. 


== Инструкции ==

Обычно, обновление до новой версии Trac включает в себя четыре шага:

=== Обновление кода Trac ===

Получите новую версию так, как это описано в TracInstall, или специфичной для вашей операционной системы процедуре.

Если вы делаете обновление вручную (не специфичное только для вашей операционной системы), вы можете потом удалить существующий код Trac путем удаления директории `trac` из директории `lib/site-packages` Python'а.

Размещение директории site-packages зависит от операционной системы, и места, куда был установлен Python. Часто встречаются следующие расположения:
 * Если вы используете Linux: /usr/lib/python2.X/site-packages
 * Если вы используете Windows: C:\Python2.X\lib\site-packages
 * Если вы используете MacOSX: /Library/Python2.X/site-packages

Вы также можете захотеть удалить `cgi-bin`, `htdocs`, `templates` и `wiki-default` директории Trac, которые часто находятся в директории с названеим `share/trac` (точное расположение зависит от вашей платформы).

> Если у вас был установлен плагин 'webadmin', вы можете удалить его, так как он теперь является частью базового кода Trac.



=== Обновление окружения Trac ===

После перезапуска Trac должен показать экземпляры которые нуждаются в ручном обновлении через автоматизированные скрипты обновления. Эти скрипты запускаются через [TracAdmin trac-admin]:
{{{
trac-admin /path/to/projenv upgrade
}}}

Эта команда ничего не сделает, если версия окружения уже обновлена.

Обратите внимание, что если вы используете базу данных PostgreSQL, эта команда завершится ошибкой с сообщением о том, что резервная копия окружения может быть сделана только при использовании базы данных SQLite. Это значит, что вам придется сделать резервную копию репозитория и базы данных вручную. После, чтобы запустить собственно обновление, выполните:
{{{
trac-admin /path/to/projenv upgrade --no-backup
}}}

=== Обновление документации Trac ===

Каждое [TracEnvironment окружение Trac] содержит документацию Trac для установленной версии. Так как вы, вероятно, хотите поддерживать встроенную документацию соответствующей установленной версии Trac, [TracAdmin trac-admin] предлагает команду для обновления документации:
{{{
trac-admin /path/to/projenv wiki upgrade
}}}

Заметьте, что эта процедура, конечно, оставит не затронутой вашу страницу `WikiStart`.

=== Макросы и Плагины Trac ===
Макросы Trac должны быть обновлены, так как макросы wiki старого формата больше не поддерживаются (изза отказа от ClearSilver и HDF); они должны быть конвертированы в новый формат макросов, смотрите WikiMacros.


=== Перезапуск Web сервера ===
Если вы не используете [wiki:TracCgi CGI], перезагрузите новый код Trac путем перезапуска вашего web сервера.

== Известные проблемы ==
=== родительская директория ===
Если вы используете trac конфигурацию с 'parent env' и один из плагинов в одном из дочерних экземпляров не работает, ни один из дочерних экземпляров не будет работать.
=== некоторые встроенные модули не загружаются === 
Это изредко может случиться с Python 2.3 на Windows, когда обновление идет без предварительного удаления программы.
Некотрые модули были сначала в верхнем регистре, а сейчас переведены в нижний, к примеру trac/About.py стал trac/about.py. Вы можете обнаружить такие сообщения в логах Trac:
{{{
ERROR: Skipping "trac.about = trac.about": (can't import "No module named about")
}}}
Удалите директорию `Lib/site-packages/trac` и переустановите программу.

== Изменение формата базы данных ==
== SQLite в PostgreSQL ==

Скрипт [http://trac-hacks.org/wiki/SqliteToPgScript sqlite2pg] на сайте [http://trac-hacks.org trac-hacks.org] был написан чтобы помочь в переходе с базы данных SQLite на PostgreSQL.

== Более старые версии ==

Для обновления с предыдущих версий, обращайтесь к wiki:0.10/TracUpgrade.

-----
Смотрите также: TracGuide, TracInstall